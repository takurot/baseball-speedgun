# スピードガン ランキング UI/UX 改善仕様

## 概要
現行の機能は維持しつつ、入力体験・閲覧体験・状態フィードバックを強化して、
「すばやく記録できる」「状況が分かる」「振り返りが楽しい」UXに改善する。

## 改善点（現状課題）
- 画面間のデザイン一貫性が弱い（ランキングはCSS、認証画面はインライン）
- ランキングは並び替え/絞り込み/検索がなく、目的の選手が探しづらい
- 追加モーダルの入力補助が少なく、入力ミスや重複に気づきにくい
- 状態表示が不足（ローディング、空状態、保存成功/失敗の通知）
- 詳細画面は視覚情報が少なく、記録の傾向やピークが読み取りづらい
- モバイルでの操作導線（FAB/ボタン/タップ領域）が十分に最適化されていない
- アクセシビリティ配慮（フォーカス、コントラスト、キーボード操作）が不足

## 目的
- 入力の手間を減らし、記録登録までの時間を短縮する
- ランキングと個別推移が直感的に理解できる情報設計にする
- モバイルでの利用体験を最適化し、片手操作を基本にする
- 状態フィードバックを強化し、安心して操作できる体験にする
- ランキングをコーチ/仲間に共有でき、コミュニケーションと振り返りを促進する

## 非ゴール
- 既存ユーザーデータ（`/users/{uid}` 配下）のスキーマ刷新や権限設計の全面変更
- 新しい競技モードや複数チーム管理などのドメイン拡張
- ネイティブアプリ化

## ユーザーフロー
### オーナー（記録者）
1. ログイン/新規登録
2. ランキング一覧を閲覧
3. 追加ボタンから記録を登録
4. ランキング更新を確認
5. 選手詳細に移動し推移/記録を確認
6. 必要に応じて記録を編集/削除
7. 必要に応じて「共有」からランキングのリンクを作成し送信

### 閲覧者（共有リンク）
1. 共有リンクを開く（ログイン不要）
2. 閲覧専用ランキングを閲覧
3. 必要に応じて「自分用に作る」からサインアップ

## 画面・機能仕様

### 共通UI/デザイン
- トーン&マナー: 「スポーツ×記録」を想起する軽快な明度と強いアクセント
- タイポグラフィ: 見出し/本文/数値を明確に分け、数値はやや強調
- 余白設計: 8pxグリッド基準でカード間隔と密度を統一
- カラーパレット: 主色/補色/警告色/成功色/無効色を定義
- コンポーネント共通化: ボタン/入力/カード/タグ/バッジ/通知
- デザイン方向: データダッシュボード調
  - 背景: 明るいグラデ（例: #F7FAFC → #E9F2FF）
  - アクセント: 視線誘導のため暖色（例: オレンジ系）
  - カード: 影は控えめ、境界線で整列感を出す
  - 数値表現: 大きめの数字 + 単位は小さく補助的に表示

### ランキング画面
- ヘッダーに「期間フィルタ」「検索」「ソート」を配置
  - 期間: 全期間 / 直近30日 / 直近7日
  - ソート: 最高速度 / 更新日 / 名前
  - 検索: 先頭一致 + 部分一致
- ランキングカード
  - 表示: 順位・選手名・最高球速・最新記録日
  - 1〜3位に視覚的強調（メダル/背景グラデ）
  - タップ領域を広げ、カード全体で詳細へ遷移
- 既存選手のクイック追加
  - 選手名クリックは詳細へ遷移（挙動を固定）
  - 行アクションに「＋/記録追加」を配置し、選手名をプリセットして入力開始
- 画面上部に「統計サマリー」
  - 最高球速/平均球速/登録選手数
- FABを「主要アクション」として強調
  - ラベル付き（例: “記録を追加”）
  - スクロール時は小型化
- 空状態
  - 例: “まだ記録がありません。最初の1球を登録しましょう。”
- ランキング共有（リンク）
  - ヘッダー/ツールバーに「共有」ボタンを追加
  - 共有モーダル
    - 「リンクを作成」→ 生成したURLを表示（コピー/OS共有）
    - 任意で有効期限を設定（例: 7日/30日/無期限）
    - 既存リンクの「無効化（削除）」を提供（再共有は再発行）
  - 共有対象は「閲覧専用ランキング（スナップショット）」とし、元データ（`/users/{uid}`）は公開しない

### 共有ランキング（閲覧専用）
- URL: `/share/:shareId`（ログイン不要）
- 表示内容
  - ランキング一覧（順位/選手名/最高球速/最新記録日）と統計サマリー
  - 追加/編集/削除などの操作は不可（FAB/行アクションは非表示）
- 状態
  - 無効/期限切れ: “この共有リンクは無効か期限切れです” + 戻る/ログイン導線
  - ローディング/エラー/空状態は通常画面と同等に表示
- CTA
  - “自分用のランキングを作る”（サインアップ/ログインへ）

### 記録追加モーダル
- 入力補助
  - 過去に登録した選手名のサジェスト
  - 直近入力の値を記憶（前回選手名、日付）
  - 単位表示の固定（km/h）
- クイック追加時の挙動
  - 選手名をプリセットし、編集不可または明示的な変更ボタンで切替
- バリデーション
  - 球速の下限/上限（例: 40〜180）
  - 必須項目の即時エラー表示
- 送信時状態
  - 保存中のローディングと二重送信防止
  - 成功/失敗のトースト通知

### 選手詳細画面
- 画面構成
  - ヘッダーに選手名と「最高球速」「平均球速」「直近記録日」
  - 折れ線グラフは縦横余白を確保し読み取りやすく
- グラフ改善
  - 点のホバー時に速度と日付を明示
  - ハイライト: 最高速度点の強調
  - 期間フィルタ（全期間/30日/7日）
- 記録一覧
  - カード or テーブルの選択（モバイルはカード）
  - 日付順/速度順の切替
  - 削除前にスナックバーで「取り消し」提供
- 空状態
  - 例: “記録がありません。追加して推移を確認しましょう。”

### ログイン/新規登録
- デザイン一貫性
  - 共通フォームスタイルとカードレイアウト
- 入力補助
  - パスワード表示切替
  - エラーメッセージの統一表現
- CTA改善
  - サブコピーで価値訴求（例: “自分専用のランキングを作ろう”）

## 状態・メッセージ設計
- ローディング
  - スケルトン表示（ランキング、詳細）
- エラー
  - 失敗理由の簡潔表示 + 再試行ボタン
- 成功
  - “記録を追加しました” のトースト
- 共有
  - “共有リンクを作成しました / コピーしました” のトースト
  - 無効化時: “共有リンクを無効化しました”
- 削除
  - 5秒以内の取り消しを提供

## アクセシビリティ
- キーボード操作対応（モーダルフォーカストラップ）
- ボタン/入力のフォーカスリングを明確化
- コントラスト比 4.5:1 以上
- 主要要素にARIAラベル付与

## レスポンシブ要件
- 360px幅でも操作可能なタップ領域（最小44px）
- FABとアクションボタンの片手操作配置
- 画面下部に「主要操作」を集約

## 変更影響（概略）
- UIコンポーネントの共通化に伴うCSS/構造の整理
- 追加の状態管理（ローディング/トースト/フィルタ）
- Firestore取得クエリの拡張（期間フィルタ/検索）
- 共有用コレクション追加とFirestore rulesの拡張（公開読み取り + オーナーのみ作成/無効化）
- 共有ページのルーティング追加（閲覧専用UI）

## 受け入れ基準
- ランキングで検索/期間/ソートが可能
- 記録追加時に入力補助と即時バリデーションが動作
- 詳細画面で統計サマリーとハイライトが確認できる
- ローディング/空状態/エラー/成功が明示される
- モバイル/デスクトップで主要操作が迷わず行える
- ランキングの共有リンクを作成してコピー/送信できる
- 共有リンクを開いた第三者が、ログインなしで閲覧専用ランキングを確認できる
