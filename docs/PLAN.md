# PRタスク計画（SPEC.md準拠）

## 方針
- UI/UX改善を段階的に導入し、各PRは独立してレビュー可能にする
- 共通デザインと状態表現を先に整備し、画面改修は順次反映
- リスクが高い機能（検索/フィルタ/Undo）は小さく切る

## PR一覧

### PR-01: デザイントークンと共通スタイル基盤
- 目的: 画面間の一貫性を確立
- 変更内容
  - カラーパレット/タイポ/余白/角丸/影/フォーカスリングのCSS変数定義
  - ボタン/入力/カード/バッジ/タグ/トーストの共通スタイル
  - 背景グラデ（データダッシュボード調）の適用
- 完了条件
  - 基本UI要素が新トークンで統一されている
- ステータス: ✅

### PR-02: ランキング画面の情報設計とクイック追加
- 目的: 一覧の可読性と追加導線の強化
- 変更内容
  - ヘッダーに検索/ソート/期間フィルタを追加
  - 統計サマリー（最高/平均/人数）を追加
  - ランキング行の再設計（速度バッジ化、更新日をセカンダリに）
  - 行アクションに「＋/記録追加」を追加（名前プリセット）
  - 空状態/ローディング/エラーの表示
- 完了条件
  - 検索/ソート/期間フィルタが機能する
  - 行アクションから記録追加ができる
- ステータス: ✅

### PR-03: 記録追加モーダルのUX改善
- 目的: 入力の手間とミスを低減
- 変更内容
  - 選手名サジェスト/直近入力の記憶
  - 球速の範囲バリデーション（例: 40〜180）
  - 送信中状態と二重送信防止
  - 成功/失敗トースト通知
  - クイック追加時の選手名プリセット挙動
- 完了条件
  - 入力補助/バリデーション/状態フィードバックが動作
- ステータス: ✅

### PR-04: 選手詳細の分析性向上
- 目的: 推移の理解と削除体験の改善
- 変更内容
  - ヘッダーにサマリー（最高/平均/直近日）
  - グラフのハイライト（最高速度点）とホバー強化
  - 期間フィルタ（全/30/7日）
  - 記録一覧の並び替え（日付/速度）
  - 削除Undo（スナックバー）
  - 空状態/ローディング
- 完了条件
  - サマリー/フィルタ/Undoが動作する
- ステータス: ✅

### PR-05: ログイン/新規登録の統一デザイン
- 目的: 認証画面の一貫性と信頼感の向上
- 変更内容
  - 共通フォームレイアウト/コンポーネントの適用
  - パスワード表示切替
  - エラー表示の統一
  - サブコピー（価値訴求）追加
- 完了条件
  - 認証画面が他画面と同じデザイン体系に揃う

### PR-06: アクセシビリティ/レスポンシブ強化
- 目的: 操作性と到達性の底上げ
- 変更内容
  - モーダルのフォーカストラップ
  - タップ領域44px基準の調整
  - コントラスト比の見直し
  - ARIAラベルの付与
  - モバイル時のFAB/行アクションの配置調整
- 完了条件
  - キーボード操作が主要フローで成立
  - モバイルで主要操作が迷わない

## 依存関係
- PR-01完了後にPR-02〜05を並行実装
- PR-06はPR-02〜05のUI確定後に実施

## テスト/確認
- 手動確認
  - 追加/削除/詳細遷移の主要導線
  - 検索/ソート/期間フィルタ
  - モバイル表示とタップ操作
- 推奨追加テスト（可能なら）
  - ランキング並び/同率順位の表示
  - モーダルバリデーション
  - 期間フィルタのクエリ結果

## 進捗
- PR-01 ✅ デザイントークン/共通スタイルを整備し、ランキング・認証・詳細・モーダルへ反映
- PR-02 ✅ ランキングに検索/ソート/期間フィルタと統計サマリーを追加し、クイック追加・空/ローディング/エラー状態を実装
- PR-03 ✅ 記録追加モーダルにサジェスト/直近入力の記憶・速度範囲バリデーション・送信中ガードとトースト通知を追加し、クイック追加時のプリセット挙動を強化
- PR-04 ✅ 選手詳細にサマリー/期間フィルタ/グラフの最高速度ハイライト/記録並び替え/削除Undoスナックバーを実装し、空・ローディング表示を追加

## Tests
- 成功: `npm test -- --watchAll=false`
- 成功: `npm run build`
- 成功: `firebase deploy --only hosting`
- 成功: Playwright MCP で https://baseball-speedgun-app.web.app の選手詳細（サマリー/期間フィルタ/削除Undo）を新規アカウントで確認
